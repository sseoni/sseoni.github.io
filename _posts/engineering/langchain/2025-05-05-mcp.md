---
layout: post

title: "MCP ê¸°ë³¸ ì´í•´"
date: 2025-05-05
tags: [ìŠ¤í„°ë””ë¡œê·¸, Langchain, NLP, LLM, MCP]
summary:
---

## **MCP (Multi-Message Prompt / Chat Prompt)**

ë‹¨ì¼ ë¬¸ìì—´ í”„ë¡¬í”„íŠ¸ë¥¼ ì‚¬ìš©í•˜ë˜ ê³¼ê±°ì˜ ë°©ì‹ê³¼ ë‹¬ë¦¬
**Chat ëª¨ë¸ì´ ì—¬ëŸ¬ ë©”ì‹œì§€ì˜ ë¬¸ë§¥ì„ ì´í•´í•  ìˆ˜ ìˆë„ë¡ "ë©”ì‹œì§€ ì‹œí€€ìŠ¤"ë¥¼ ì „ë‹¬í•˜ëŠ” ë°©ì‹**

```python
[System] You are a helpful assistant.
[User] Tell me a joke.
[AI] Why did the chicken cross the road?
[User] Explain it.
```

LangChainì€ ë©”ì„¸ì§€ ì‹œí€€ìŠ¤ë¥¼ ì½”ë“œë¡œ êµ¬ì„±í•˜ê¸° ìœ„í•´ ChatPromptTemplate + MessageTemplatesë¥¼ ë„ì…

ìµœê·¼ LangChainì—ì„œ íŠ¹íˆÂ **ChatPromptTemplate**,Â **MessagesPlaceholder**, **SystemMessagePromptTemplate**Â ë“±ì˜Â **ë©€í‹° ë©”ì‹œì§€ ê¸°ë°˜ í”„ë¡¬í”„íŠ¸ ì„¤ê³„**ê°€ ì¤‘ìš”

## MCPì™€ ê´€ë ¨ëœ í”„ë¡¬í”„íŠ¸ êµ¬ì„± ìš”ì†Œë“¤

| ê°œë…/í´ë˜ìŠ¤ | ì„¤ëª… | ìµœê·¼ íë¦„ì—ì„œ ì¤‘ìš”ë„ |
| --- | --- | --- |
| `ChatPromptTemplate` | ì—¬ëŸ¬ ë©”ì‹œì§€(role í¬í•¨)ë¥¼ ì¡°í•©í•˜ëŠ” í…œí”Œë¦¿ | â­â­â­â­â­ |
| `SystemMessagePromptTemplate` | ì‹œìŠ¤í…œ ë©”ì‹œì§€ë¥¼ í…œí”Œë¦¿ìœ¼ë¡œ ì •ì˜ | â­â­â­â­ |
| `HumanMessagePromptTemplate` | ì‚¬ìš©ì ë©”ì‹œì§€ ì •ì˜ | â­â­â­â­ |
| `AIMessagePromptTemplate` | AIì˜ ì´ì „ ì‘ë‹µ ë©”ì‹œì§€ | â­â­â­ |
| `MessagesPlaceholder` | ì´ì „ ëŒ€í™” ë‚´ì—­ì„ ë³€ìˆ˜ë¡œ ì „ë‹¬ (e.g., memory) | â­â­â­â­â­ |
| `PromptTemplate` | ì „í†µì ì¸ ë¬¸ìì—´ ê¸°ë°˜ í…œí”Œë¦¿ | ğŸ”„ ë ˆê±°ì‹œ / ì—¬ì „íˆ ì‚¬ìš© ê°€ëŠ¥ |
| `ChatMessage` | ë‹¨ì¼ ë©”ì‹œì§€ ê°ì²´ (ì—­í•  + ë‚´ìš© í¬í•¨) | ğŸ”§ ë‚´ë¶€ì ìœ¼ë¡œ ì‚¬ìš©ë¨ |

## ìµœì‹  í”„ë¡¬í”„íŠ¸ êµ¬ì„± ë°©ì‹

```python
from langchain.prompts.chat import (
    ChatPromptTemplate,
    SystemMessagePromptTemplate,
    HumanMessagePromptTemplate,
    MessagesPlaceholder
)

from langchain.chat_models import ChatOpenAI
from langchain.schema.output_parser import StrOutputParser

prompt = ChatPromptTemplate.from_messages([
    SystemMessagePromptTemplate.from_template("You are a helpful assistant."),
    MessagesPlaceholder(variable_name="chat_history"),
    HumanMessagePromptTemplate.from_template("{input}")
])

llm = ChatOpenAI()
chain = prompt | llm | StrOutputParser()

result = chain.invoke({
    "input": "What is the capital of France?",
    "chat_history": []
})

```

| ì»´í¬ë„ŒíŠ¸ | ì—­í•  |
| --- | --- |
| `SystemMessagePromptTemplate` | ì´ˆê¸° ì‹œìŠ¤í…œ ì—­í•  ì§€ì • (ì§€ì‹œì–´) |
| `MessagesPlaceholder` | ì´ì „ ëŒ€í™” ë‚´ì—­ì„ ê¸°ì–µ (memory ì—°ë™ë¨) |
| `HumanMessagePromptTemplate` | ì‚¬ìš©ìì˜ ì‹¤ì œ ì…ë ¥ |
| `AIMessagePromptTemplate` | AIì˜ ì‘ë‹µì„ ëª…ì‹œì ìœ¼ë¡œ ì „ë‹¬í•  ìˆ˜ë„ ìˆìŒ |
| `ChatPromptTemplate` | ìœ„ êµ¬ì„± ìš”ì†Œë“¤ì„ ì¡°í•©í•˜ëŠ” ìƒìœ„ í…œí”Œë¦¿ |